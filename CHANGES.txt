LE DOSSIER - PROJECT CHANGES DOCUMENTATION
==========================================

SETUP & DEPENDENCIES [2026-02-14 05:52]
-------------------
- Installed Node.js and npm
- Installed Expo and React Native dependencies
- Installed Google Fonts: Petit Formal Script (titles) and Noto Serif (body text)
- Installed react-native-svg for SVG support
- Installed expo-gl for WebGL shader support
- Installed React Navigation for page navigation

PAGES CREATED [2026-02-14 05:52]
-------------
1. Home.tsx - Main landing page
2. IdeaVault.tsx - Secondary page
3. Notification.tsx - Notification page (blank)
4. Setting.tsx - Settings page (blank)

HOME PAGE DESIGN [2026-02-14 05:52]
----------------
Background:
- Dark background color: #0C001A
- WebGL shader with wavy horizontal lines in #FFFDEE
- Lines fade from top (more visible) to bottom (less visible)
- Line spacing: 10px, Line width: 4px

Title Section:
- Text: "Le Dossier"
- Font: Petit Formal Script, 72px, bold
- Color: #FFFDEE
- Positioned at top 2.5% margin, takes up 15% of page height
- Horizontally stretched with scaleX: 2.5
- Letter spacing: 10px
- Background rectangle in #0C001A behind title spanning full width

Center Shape:
- Combined triangle + rectangle shape
- Rectangle: 50% page width, 30% page height
- Triangle: Right triangle on top, half the height of rectangle
- Color: #FFFDEE
- Rounded corners: 10px border radius
- Positioned: Center of screen
- Overlay: Wavy line pattern in #0C001A fading left to right
- Triangle and rectangle overlap by 20px for seamless connection

Sign In Button:
- Located on right 50% of the center shape
- Positioned 10% down from top of shape
- Text: "SIGN IN" displayed vertically (one letter per line)
- Font: Noto Serif, 48px, bold
- Color: #0C001A
- Hover effect: Animated wavy vertical lines in #FFFDEE
- Lines move continuously with seamless tiling
- Lines fade from left (visible) to right (transparent)
- Line width: 8px to match background
- Navigation: Clicking navigates to IdeaVault page

IDEA VAULT PAGE [2026-02-14 05:52]
---------------
- Dark background: #0C001A
- Text: "Idea Vault" in #FFFDEE
- Test button to navigate back to Home

NAVIGATION [2026-02-14 05:52]
----------
- React Navigation with Native Stack Navigator
- No headers shown
- Home screen is default
- Sign In button navigates to IdeaVault
- Test button on IdeaVault navigates back to Home

COLOR PALETTE [2026-02-14 05:52]
-------------
- Primary Background: #0C001A (dark purple/navy)
- Primary Text/Accent: #FFFDEE (cream/off-white)

FONTS [2026-02-14 05:52]
-----
- Titles/Headers: Petit Formal Script (400 Regular)
- Body Text: Noto Serif (400 Regular)

TECHNICAL NOTES [2026-02-14 05:52]
---------------
- WebGL shader uses expo-gl for background effect
- GLView remounts on navigation using state-based key
- Animated API used for smooth line movement on hover
- SVG patterns with quadratic curves for wavy lines
- Gradients applied using SVG linearGradient with opacity
- All pages use same background color for consistency
- Responsive design using useWindowDimensions hook

GIT COMMITS [2026-02-14 05:52]
-----------
- Commit: "set up pages" - Initial page setup with navigation and styling

BUG FIXES & CHANGES
-------------------

[2026-02-14 05:52] Fixed wavy line pattern on rectangle+triangle not persisting after navigation
  - Changed gradient mask to use proper white color stops with opacity
  - Used nested masks: shapeMask for boundary, fadeMask for gradient fade
  - Pattern now properly displays and persists across navigation

[2026-02-14 05:52] Fixed sign-in button hover animation not persisting after navigation
  - Changed gradient to use white color stops with stopOpacity instead of opacity-only stops
  - Wrapped pattern rect in mask using the gradient
  - Invalid opacity=\"url(#gradient)\" replaced with mask=\"url(#mask)\" pattern

[2026-02-14 05:52] Fixed center shape wavy pattern not persisting after navigation
  - Added state-based key to SVG element that increments on mount
  - Changed from nested masks to clipPath for shape boundary
  - Applied gradient as overlay rect instead of mask for fade effect
  - Pattern now persists properly after navigation
[2026-02-14 05:52] Fixed hover animation to continue forever
  - Moved animation start to component mount instead of hover trigger
  - Animation runs continuously, hover only shows/hides the animated layers

[2026-02-14 05:52] Replaced SVG Pattern elements with direct path rendering
  - React Native SVG has issues with Pattern persistence after navigation
  - Now renders wavy lines as individual path elements using Array.map
  - Both center shape and hover animation use direct rendering
  - Patterns now persist correctly after navigation

[2026-02-14 05:52] Removed all WebGL shader logic from Home.tsx
  - Deleted GLView component and onContextCreate function
  - Removed expo-gl import
  - Removed glKey state
  - Background now uses plain backgroundColor style

[2026-02-14 05:52] Reinstated background WebGL shader with wavy horizontal lines
  - Added back GLView, expo-gl import, onContextCreate function, glKey state
  - Background shader persists with key-based remounting
[2026-02-14 05:52] Removed all animation logic from sign-in button
  - Deleted Animated.View components with wavy line patterns
  - Removed animValue, translateX, and animation loop
  - Button now shows plain text only

[2026-02-14 05:52] Changed rectangle+triangle shape color back to #0C001A (dark background)
  - Removed wavy line overlay pattern
  - Sign in text color changed to #FFFDEE (cream) for visibility

[2026-02-14 05:52] Corrected rectangle+triangle shape to #FFFDEE (cream) with #0C001A (dark) text

[2026-02-14 05:52] Added light rectangle to IdeaVault page
  - Rectangle spans 80% of screen width and height
  - Border uses same WebGL shader as Home page background (wavy horizontal lines)
  - Border width: 10px
  - Inner rectangle color: #FFFDEE (cream)
  - Shader border created using GLView with inner rect using margin

[2026-02-14 05:52] Added navigation buttons to IdeaVault page
  - Two rounded cream square buttons in top left corner
  - Top button (N): Navigates to Notification page
  - Bottom button (S): Navigates to Setting page
  - Button size: 50x50px, border radius: 10px
  - Button color: #FFFDEE, text color: #0C001A
  - Positioned at top: 20px and 80px, left: 20px
[2026-02-14 05:52] Added back buttons to Notification and Setting pages
  - Both pages now have "Back to Idea Vault" button
  - Navigates back to IdeaVault page

[2026-02-14 05:52] Added Notification and Setting screens to navigation stack in App.tsx
  - Imported both screen components
  - Registered as Stack.Screen components
  - Navigation buttons now properly change pages

[2026-02-14 05:52] Added "Add Idea" button below rectangle on IdeaVault page
  - Opens modal panel with name and description text inputs
  - Panel has cream background (#FFFDEE) with dark text
  - Confirm button logs name and description to console and closes panel
  - Delete button closes panel and clears inputs
  - Modal has semi-transparent dark overlay

[2026-02-14 05:52] Removed non-palette colors from IdeaVault page
  - Changed input background from white to #FFFDEE
  - Changed button colors from default/red to #0C001A
  - All colors now use only #0C001A (dark) and #FFFDEE (cream)

[2026-02-14 05:52] Replaced Button components with TouchableOpacity for custom styling
  - Add Idea and test buttons now use #FFFDEE background with #0C001A text
  - Confirm and Delete buttons use #0C001A background with #FFFDEE text
  - Removed all default blue button colors

[2026-02-14 05:52] Changed "Add Idea" button text to "IDEATE"

[2026-02-14 05:52] Tilted IdeaVault border shader lines by 30 degrees
  - Applied rotation matrix to fragment coordinates
  - Lines now appear at 30-degree angle instead of horizontal

[2026-02-14 05:52] Added temporary storage for ideas on IdeaVault page
  - Created ideas state array to store idea objects
  - Each idea object contains: name, description, and unique id (timestamp)
  - Confirm button now creates and stores idea object in state
  - Console logs show stored idea and all ideas array

[2026-02-14 05:52] Added validation for ideate panel
  - Alert pops up if confirm pressed without both name and description
  - Checks for empty or whitespace-only inputs
[2026-02-14 05:52] Added bullet point button to description field
  - Circular button with bullet symbol in bottom right of description input
  - Adds bullet point character to description when pressed
  - Button styled with #0C001A background and #FFFDEE text

[2026-02-14 05:52] Fixed validation alert not showing
  - Replaced Alert.alert with custom modal for cross-platform compatibility
  - Custom alert styled with project colors (#FFFDEE background, #0C001A text)
  - Alert now properly displays when name or description is missing

[2026-02-14 05:55] Changed Home background shader line behavior
  - Lines now become thinner at the top instead of fading with transparency
  - Line width varies from 0px (top) to 10px (bottom) using gradient (1.0 - uv.y)
  - Increased line spacing from 10px to 20px
  - Added blur effect using smoothstep for softer line edges
  - Removed alpha/transparency gradient, lines now fully opaque

[2026-02-14 05:55] Attempted NativeWind migration and full rollback
  - Installed nativewind and tailwindcss packages (40 packages added)
  - Created tailwind.config.js with custom colors (dark-bg: #0C001A, cream: #FFFDEE)
  - Created babel.config.js with nativewind/babel plugin
  - Created global.css file for NativeWind
  - Migrated Notification.tsx, Setting.tsx, and IdeaVault.tsx buttons to className syntax
  - Encountered "everything is on fire" compatibility issues
  - Fully reverted all changes using git checkout for modified files
  - Uninstalled nativewind and tailwindcss (40 packages removed)
  - Deleted tailwind.config.js, babel.config.js, and global.css
  - Conclusion: StyleSheet approach is more reliable for this project with Expo, WebGL, and SVG

[2026-02-14 06:00] Attempted rich text editor installation - reverted
  - Tried react-native-pell-rich-editor (WebView-based) - not supported by Expo
  - Tried @10play/tentap-editor (79 packages) - compatibility issues with React Native
  - Both libraries had platform/dependency conflicts
  - Reverted to plain multiline TextInput for description field
  - Conclusion: Native TextInput is most reliable for Expo projects

[2026-02-14 06:10] Removed all formatting buttons from description field
  - Removed toolbar with bullet and numbered list buttons
  - Description field is now plain multiline TextInput
  - Removed insertFormat function and descInputRef
  - Uninstalled react-native-markdown-display (no longer needed)

[2026-02-14 06:15] Changed app icon to door.png
  - Updated app.json to use door.png as icon
  - Updated Android adaptive icon to use door.png
  - Applies to both iOS and Android builds

[2026-02-14 06:20] Added custom page transition animation
  - Created PageTransition component with door.png expanding animation
  - First animation: door.png scales from 0 to fill screen (400ms)
  - Second animation: dark-tinted door.png scales to reveal new page (400ms)
  - Disabled default navigation animations
  - Transition triggers on all page navigations

[2026-02-14 20:45] Fixed critical issues and improved code quality
  - Installed react-native-gesture-handler (~2.28.0) as required peer dependency for @react-navigation/stack
  - Removed eas-cli from devDependencies (should be installed globally instead)
  - Fixed app.json schema errors by removing empty owner and projectId fields
  - Cleaned up CHANGES.txt by removing duplicate and corrupted entries
  - Added TypeScript types to all screen components (Home, IdeaVault, Notification, Setting)
  - Added NavigationProp interface for navigation props in all screens
  - Added ExpoWebGLRenderingContext type for WebGL context parameters
  - Created Idea interface for type-safe idea storage in IdeaVault
  - Added null checks for WebGL shader creation in Home.tsx and IdeaVault.tsx
  - Removed unused isHovered state and mouse event handlers from Home.tsx
  - Removed unused svgKey state variable from Home.tsx
  - Removed unused imports: useRef, Polygon, Alert, Button, Image
  - Fixed PageTransition.tsx code quality: changed var to const, added TypeScript interface
  - Replaced deprecated scaleX property with transform="scale(2.5, 1)" in SVG
  - All 17 Expo doctor checks now pass
  - All TypeScript compilation errors resolved

[2026-02-14 20:50] Fixed page navigation rendering issues
  - Removed all custom transitions that were preventing pages from appearing
  - Simplified Stack.Navigator to use default transitions only
  - Added proper loading indicator with ActivityIndicator while fonts load
  - Pages now render correctly without transition interference

[2026-02-14 20:55] Temporarily disabled WebGL shaders for debugging
  - Commented out GLView in Home.tsx to diagnose crash issue
  - Commented out GLView in IdeaVault.tsx to diagnose crash issue
  - Pages appear briefly then disappear - investigating WebGL shader crashes
  - Need to fix shader implementation or find alternative background solution

[2026-02-14 21:00] Simplified screens to minimal components for debugging
  - Replaced Home.tsx complex SVG layout with simple Text and TouchableOpacity
  - Replaced IdeaVault.tsx complex layout with simple buttons
  - Testing if SVG components or layout complexity is causing the crash
  - If pages still disappear, issue is in navigation or React lifecycle

[2026-02-14 21:05] Identified and fixed the issue - WebGL shaders AND SVG causing crashes
  - Minimal components stay visible - confirmed issue is with WebGL shaders AND SVG components
  - Both WebGL and complex SVG components cause rendering crashes in React Native
  - Completely redesigned screens using only basic View, Text, and TouchableOpacity components
  - Removed all WebGL (GLView) and SVG (polygon, SvgText, SvgRect) components
  - Home.tsx: Simple centered layout with title and sign-in button
  - IdeaVault.tsx: Clean layout with header navigation, content box, and footer buttons
  - App now renders correctly and stays visible without crashes
  - All functionality preserved (navigation, modals, idea storage)
  - Note: Original animated backgrounds and SVG styling removed for stability

[2026-02-14 21:15] Implemented custom door.png page transition animation
  - Created DoorTransition component in App.tsx
  - Door image scales from 0.1x to 35x over 400ms (expanding effect)
  - Door rotates 360 degrees while expanding for dynamic effect
  - Then fades out over 300ms to reveal new page
  - Transition triggers on all navigation events
  - Disabled default React Navigation transitions (instant page switches)
  - Overlay positioned with zIndex 1000 to appear above all content
  - Uses Animated API with cubic easing for smooth animation
  - Increased scale to 35x to ensure door fully covers entire screen

[2026-02-14 21:20] Fixed transition flash issue
  - Changed overlay container from Animated.View to View with solid background
  - Background color (#0C001A) now immediately covers screen when transition starts
  - Only the door image fades out, not the entire overlay
  - Eliminates brief flash of new page before transition animation begins

[2026-02-14 21:25] Removed Settings page
  - Deleted screens/Setting.tsx file
  - Removed Setting import from App.tsx
  - Removed Setting Stack.Screen from navigation
  - Removed Settings button from IdeaVault.tsx header

[2026-02-14 21:30] Updated web favicon
  - Added web configuration to app.json
  - Set favicon to door.png for web builds

[2026-02-14 21:35] Added authentication flow with Flask backend
  - Created new SignIn screen (screens/SignIn.tsx)
  - Integrated WebView for OAuth authentication with Flask/Cognito
  - Installed react-native-webview package
  - Updated navigation flow: Home → SignIn → IdeaVault
  - Home screen now routes to SignIn instead of directly to IdeaVault
  - SignIn screen handles OAuth flow via Flask backend at localhost:5000
  - WebView monitors navigation to detect successful authentication
  - Added cancel button to exit authentication flow
  - Styled SignIn page to match app theme (dark purple and cream)

[2026-02-14 21:40] Fixed WebView platform compatibility issue
  - Replaced react-native-webview with expo-web-browser (cross-platform compatible)
  - Installed expo-auth-session and expo-web-browser packages
  - Updated SignIn.tsx to use WebBrowser.openAuthSessionAsync for OAuth flow
  - Opens authentication in system browser instead of embedded WebView
  - Added deep linking scheme "ledossier://" to app.json for OAuth callbacks
  - Works on iOS, Android, and Web platforms
  - Added loading state with message "Opening browser for authentication..."

[2026-02-14 21:45] Configured complete Cognito OAuth flow
  - Updated Flask main.py to use /authorize endpoint as OAuth callback
  - Flask /authorize now redirects to app using deep link: ledossier://auth?email=X&success=true
  - Installed expo-linking package for deep link handling
  - Added deep link listener in SignIn.tsx to detect OAuth callback
  - Parses email and success parameters from deep link URL
  - Automatically navigates to IdeaVault on successful authentication
  - Added error handling and error message display for failed authentication
  - Deep link callback format: ledossier://auth with query parameters
